---
// Import main component
import CardProject from "./Card-Project.astro";
// Imports Badges
import BadgeCode from "./badges/Badge-Code.astro";
import BadgePreview from "./badges/Badge-Preview.astro";
import BadgeTemplate from "./badges/Badge-Template.astro";
// Imports Icons
import DjangoIcon from "./icons/Django-Icon.astro";
import JsIcon from "./icons/Js-Icon.astro";
// Imports Images
import Project1_WEB from "/public/login.webp";

---

<!-- Projects -->
<section class="my-10">
  <h1 class="text-3xl font-bold text-gray-900 mb-10">Proyectos</h1>
  <!-- Carrusel -->
  <div class="relative overflow-hidden">
    <!-- Contenedor de proyectos -->
    <div id="projectContainer" class="flex transition-transform duration-300 ease-in-out">
      <!-- Proyecto 1 -->
      <div class="w-full flex-none">
        <CardProject
          title="Project 1"
          body={`Aquí va la descripción del proyecto. 
          Puedes escribir en varias líneas usando el 
          operador de interpolación de cadenas (backticks) 
          en JavaScript. Esto permite una mayor legibilidad 
          y organización del texto.
          `}
          img= {Project1_WEB}
          href_code="https://github.com"
          href_preview="https://lapalabradeldia.com"
        >
          <BadgePreview slot="preview" />
          <BadgeCode slot="code" />
          <slot slot="technologies">
            <BadgeTemplate className="bg-green-100 text-green-900">
              <DjangoIcon /> Django
            </BadgeTemplate>
            <BadgeTemplate className="bg-yellow-100 text-yellow-700">
              <JsIcon /> Java Script
            </BadgeTemplate>
          </slot>
        </CardProject>
      </div>
      <!-- Proyecto 2 -->
      <div class="w-full flex-none">
        <CardProject
          title="Project 2"
          body={`Aquí va la descripción del proyecto. 
            Puedes escribir en varias líneas usando el 
            operador de interpolación de cadenas (backticks) 
            en JavaScript. Esto permite una mayor legibilidad 
            y organización del texto.
            `}
          img="https://www.pap.pl/sites/default/files/styles/main_image/public/202306/pap_20221218_2FS.jpg?h=14531cb3&itok=1LEK6_AJ"
          href_code="https://github.com"
          href_preview="https://lapalabradeldia.com"
        >
          <BadgePreview slot="preview" />
          <BadgeCode slot="code" />
          <slot slot="technologies">
          </slot>
        </CardProject>
      </div>
      <!-- Proyecto 3 -->
      <div class="w-full flex-none">
        <CardProject
          title="Project 3"
          body={`Aquí va la descripción del proyecto. 
          Puedes escribir en varias líneas usando el 
          operador de interpolación de cadenas (backticks) 
          en JavaScript. Esto permite una mayor legibilidad 
          y organización del texto.
          `}
          img="https://www.pap.pl/sites/default/files/styles/main_image/public/202306/pap_20221218_2FS.jpg?h=14531cb3&itok=1LEK6_AJ"
          href_code="https://github.com"
          href_preview="https://lapalabradeldia.com"
        >
          <BadgePreview slot="preview" />
          <BadgeCode slot="code" />
          <slot slot="technologies">
          </slot>
        </CardProject>
      </div>
    </div>
    <!-- Fin Contenedor de proyectos -->

    <!-- Slider controls -->
    <!-- Previous Card -->
    <button id="prevBtn" type="button" class="absolute top-0 start-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-prev>
      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none">
          <svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4"/>
          </svg>
      </span>
  </button>
  <!-- Next Card -->
  <button id="nextBtn" type="button" class="absolute top-0 end-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none" data-carousel-next>
      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50 group-focus:ring-4 group-focus:ring-white group-focus:outline-none">
          <svg class="w-4 h-4 text-white rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4"/>
          </svg>
      </span>
  </button>
    </div>
  </div>
</section>

<script>
  // Variables para el carrusel
  const projectContainer = document.getElementById("projectContainer");
  const projects = Array.from(projectContainer.children);
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");

  let currentIndex = 0;
  const totalProjects = projects.length;

  // Función para mover el carrusel a la izquierda
  function moveLeft() {
    currentIndex = (currentIndex - 1 + totalProjects) % totalProjects;
    updateCarousel();
  }

  // Función para mover el carrusel a la derecha
  function moveRight() {
    currentIndex = (currentIndex + 1) % totalProjects;
    updateCarousel();
  }

  // Actualiza la posición del carrusel según currentIndex
  function updateCarousel() {
    const projectWidth = projects[currentIndex].getBoundingClientRect().width;
    const newPosition = -currentIndex * projectWidth;

    // Aplicar transición suave al cambiar la posición
    projectContainer.style.transition = "transform 0.50s ease-in-out";
    projectContainer.style.transform = `translateX(${newPosition}px)`;
  }

  // Mostrar el primer proyecto al inicio
  updateCarousel();

  // Event listeners para los botones de navegación
  prevBtn.addEventListener("click", moveLeft);
  nextBtn.addEventListener("click", moveRight);
</script>
